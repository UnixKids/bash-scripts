#!/bin/bash


OS_RELEASE=$( awk /'VERSION_ID='/'{print $1}' /etc/os-release | grep -Po '\d{1}')

function box(){
for i in $(seq 134)
do
printf '-'
done
printf \\n
}

if [[ $OS_RELEASE -eq 7 ]];
then
	box
	printf "\t\t\t\t\t\t\t $1 - Recent max_children  \n"
	grep 'server reached max_children setting' /var/opt/remi/php*/log/php-fpm/error.log | grep $1 | tail 
	box
	printf "\t\t\t\t\t\t\t $1 - Auto-scale information  \n"
	autoscaleinfo $1 | head -4
	grep $1 /var/log/autoscale.log | tail

elif [[ $OS_RELEASE -eq 6 ]];
then
	box
	printf "\t\t\t\t\t\t\t $1 \n"
	for PHP in $(ls /var/opt/remi/php*/log/php-fpm/error.log)
	do
	grep max_children $PHP | grep $1
	done
else
	printf 'Please specify a valid user'
fi
